# 听听音乐软件功能扩展计划

## 1. 新增虚拟环境
- 在项目根目录创建虚拟环境
- 配置虚拟环境依赖
- 更新开发工作流程

## 2. 软件改名"听听音乐"
- 修改HTML页面标题
- 更新API标题和描述
- 修改Docker容器名称
- 更新所有相关配置

## 3. 完善播放列表管理
- 数据库模型扩展：添加播放列表相关表
- API接口扩展：播放列表的增删改查
- 前端界面扩展：播放列表创建、编辑、删除功能
- 播放列表播放功能

## 4. 添加歌词支持
- 歌词文件解析（支持LRC格式）
- 数据库模型扩展：添加歌词表
- API接口扩展：获取歌词
- 前端界面扩展：歌词显示和同步功能

## 5. 提供启动脚本
- Windows批处理脚本（.bat）
- 包含虚拟环境激活和服务启动
- 支持参数配置

## 实现步骤

### 步骤1：创建虚拟环境
```bash
python -m venv venv
```

### 步骤2：修改软件名称
- 更新HTML模板中的标题
- 修改FastAPI应用的标题和描述
- 更新Docker配置中的容器名称

### 步骤3：扩展数据库模型
- 添加Playlist和PlaylistTrack表
- 添加Lyrics表

### 步骤4：实现播放列表API
- 新增播放列表相关端点
- 实现播放列表与歌曲的关联

### 步骤5：实现歌词功能
- 添加歌词解析逻辑
- 实现歌词同步显示

### 步骤6：创建启动脚本
- 编写Windows批处理脚本
- 测试脚本功能

## 技术细节

### 播放列表模型设计
```python
class Playlist(Base):
    __tablename__ = "playlists"
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String, index=True)
    tracks = relationship("PlaylistTrack", back_populates="playlist")

class PlaylistTrack(Base):
    __tablename__ = "playlist_tracks"
    id = Column(Integer, primary_key=True, index=True)
    playlist_id = Column(Integer, ForeignKey("playlists.id"))
    track_id = Column(Integer, ForeignKey("tracks.id"))
    order = Column(Integer)
    playlist = relationship("Playlist", back_populates="tracks")
    track = relationship("Track")
```

### 歌词模型设计
```python
class Lyric(Base):
    __tablename__ = "lyrics"
    id = Column(Integer, primary_key=True, index=True)
    track_id = Column(Integer, ForeignKey("tracks.id"), unique=True)
    content = Column(Text)
    track = relationship("Track", back_populates="lyric")
```

### 启动脚本设计
```batch
@echo off
REM 听听音乐启动脚本

REM 激活虚拟环境
call venv\Scripts\activate

REM 启动服务
uvicorn app.backend.main:app --reload

pause
```

## 预期效果
- 项目使用虚拟环境进行开发和调试
- 软件名称改为"听听音乐"
- 支持播放列表的创建、编辑和播放
- 支持歌词显示和同步
- 提供便捷的Windows启动脚本